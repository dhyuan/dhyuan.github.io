<!DOCTYPE HTML>
<html lang="zh-CN">
<head>
  <meta charset="utf-8">
  
  <title>Performance Test 101 | 浅流</title>
  <meta name="author" content="Dahui">
  
  <meta name="description" content="无论是哪种测试：单元测试、集成测试、回归测试等，目的都是找到 breaking points、消除性能瓶颈。
对于 Performance Test 来说，我们希望在期望的负载下验证我们的系统是否在 速度、 伸缩性、 稳定性 方面满足系统对性能的需求。一般来说我们希望系统能在 RPS 和 laten">
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="Performance Test 101"/>
  <meta property="og:site_name" content="浅流"/>

  
    <meta property="og:image" content=""/>
  

  <link rel="shortcut icon" href="/favicon.png">
  
  
<link rel="stylesheet" href="/css/style.css">

  <!--[if lt IE 9]><script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script><![endif]-->
  

<meta name="generator" content="Hexo 5.4.0"></head>


<body>
  <header id="header" class="inner"><div class="alignleft">
  <h1><a href="/">浅流</a></h1>
  <h2><a href="/"></a></h2>
</div>
<nav id="main-nav" class="alignright">
  <ul>
    
      <li><a href="/null">Home</a></li>
    
      <li><a href="/archives">Archives</a></li>
    
  </ul>
  <div class="clearfix"></div>
</nav>
<div class="clearfix"></div>
</header>
  <div id="content" class="inner">
    <div id="main-col" class="alignleft"><div id="wrapper"><article id="post-notes/test/Performance-Test-101" class="h-entry post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time class="dt-published" datetime="2022-09-30T07:55:38.000Z"><a href="/2022/09/30/notes/test/Performance-Test-101/">2022-09-30</a></time>
      
      
  
    <h1 class="p-name title" itemprop="headline name">Performance Test 101</h1>
  

    </header>
    <div class="e-content entry" itemprop="articleBody">
      
        <p>无论是哪种测试：单元测试、集成测试、回归测试等，目的都是找到 breaking points、消除性能瓶颈。</p>
<p>对于 Performance Test 来说，我们希望在期望的负载下验证我们的系统是否在 <strong>速度</strong>、 <strong>伸缩性</strong>、 <strong>稳定性</strong> 方面满足系统对性能的需求。一般来说我们希望系统能在 RPS 和 latency 之间达到一个不错的平衡。</p>
<p>最最基础的两个指标：</p>
<p><strong>RPS</strong> (request per sec):<br>每秒系统可接受/处理的请求数。值得注意的时，虽然请求可被接收或者处理，但是处理的结果可能是正常启动的 value 也有可能因为系统压力的原因而是 Error。</p>
<p>这篇文章讲了<a target="_blank" rel="noopener" href="https://medium.com/@novyludek/virtual-users-vs-rps-77627b384127">RPS 和 Virtual User 的概念</a> ，可以帮助理解为什么不是 RPS 越高越好而是 RPS 与 Latence 之间的平衡。其中讲到 Virutal User 的生命周期是到测试结束，这一点对我们理解和写测试代码挺重要的。<br><code>The typical virtual user life cycle looks like this — it picks up the scripted tasks and performs them, once it finishes all of them it will start the loop again. And it keeps it going until the test is terminated.</code></p>
<p>这个和 <a target="_blank" rel="noopener" href="https://docs.locust.io/en/stable/quickstart.html#locust-s-web-interface">Locust 文档</a> 中描述的行为是一致的: <code>This user will make HTTP requests to /hello, and then /world, again and again. </code></p>
<p><strong>Latency</strong>:<br>从请求被创建出来发送到接收的 endpint 开始到收到 response 的这个段时间。</p>
<h2 id="1-性能测试类型"><a href="#1-性能测试类型" class="headerlink" title="1. 性能测试类型"></a>1. 性能测试类型</h2><p>这里列出的类型分类是从稍微具体一点的关注点来分类的。我们做性能测试就是希望在下面几个方面得到系统当前的处理能力，以及它的 breaking points。</p>
<ul>
<li><p>负载测试 Load Test</p>
</li>
<li><p>压力测试 Stress Test</p>
</li>
<li><p>耐久/疲劳测试 Endurance Test</p>
</li>
<li><p>尖峰测试 Spike Test</p>
</li>
<li><p>容量 Volume Test</p>
</li>
<li><p>伸缩测试 Scaliability Test</p>
</li>
</ul>
<p><em>Load testing</em> – checks the application’s ability to perform under anticipated user loads. The objective is to identify performance bottlenecks before the software application goes live.</p>
<p><em>Stress testing</em> – involves testing an application under extreme workloads to see how it handles high traffic or data processing. The objective is to identify the breaking point of an application.</p>
<p><em>Endurance testing</em> – is done to make sure the software can handle the expected load over a long period of time.</p>
<p><em>Spike testing</em> – tests the software’s reaction to sudden large spikes in the load generated by users.</p>
<p><em>Volume testing</em> – Under Volume Testing large no. of. Data is populated in a database and the overall software system’s behavior is monitored. The objective is to check software application’s performance under varying database volumes.</p>
<p><em>Scalability testing</em> – The objective of scalability testing is to determine the software application’s effectiveness in “scaling up” to support an increase in user load. It helps plan capacity addition to your software system.</p>
<h2 id="2-性能测试的三个方面"><a href="#2-性能测试的三个方面" class="headerlink" title="2. 性能测试的三个方面"></a>2. 性能测试的三个方面</h2><p>上面列出的几个测试关注点，都可以放到这三点：速度、伸缩性、稳定性。<br>速度: 负载测试, 压力测试<br>伸缩: 压力测试, Spike Test, Volume Test, Scaliability Test<br>稳定性: Endurance testing</p>
<h3 id="1-有多快？——-速度"><a href="#1-有多快？——-速度" class="headerlink" title="1. 有多快？—— 速度"></a>1. 有多快？—— 速度</h3><p>常用指标：</p>
<ul>
<li>加载时长 Load time</li>
<li>响应时长 Response time</li>
<li>RPS</li>
<li>每秒网络字节数 Network bytes total per second</li>
<li>网络输出队列长度 Network output queue length</li>
<li>…</li>
</ul>
<p>只看平均值是没有太多意义的，要看百分比分布。</p>
<h3 id="2-还能有多快？-——-伸缩性"><a href="#2-还能有多快？-——-伸缩性" class="headerlink" title="2. 还能有多快？ —— 伸缩性"></a>2. 还能有多快？ —— 伸缩性</h3><p>这里的 scalability 是说在外部请求不断增加的情况下，系统的资源分配是否能支持这些增加的负载。同样我们也期望当外部负载变小时，系统占用的资源也能够释放出来。<br>这里的 memeory footprint、CPU usage、bandwidth usage 都是系统垂直伸缩的指标。<br>如果系统支持水平伸缩，那么就要看系统是否能够在输入负载增加的情况下，系统是否能够通过水平扩展节点来保持期望的处理速度。</p>
<p>常用指标：</p>
<ul>
<li>内存</li>
<li>带宽</li>
<li>CPU</li>
<li>并发用户数</li>
<li>系统处理节点</li>
<li>… …</li>
</ul>
<h3 id="3-可以持续多久？——-稳定性"><a href="#3-可以持续多久？——-稳定性" class="headerlink" title="3. 可以持续多久？—— 稳定性"></a>3. 可以持续多久？—— 稳定性</h3><p>持续的给系统一定的输入负载，看看系统是否能够正常处理请求。一般来说，通过这种持续性测试可以发现系统是否能够对使用后的资源进行了释放，比如内存泄露的情况。<br>如果使用 Gatling，对应如下语句进行 stability 的测试。</p>
<pre><code>jumpToRps(20),
holdFor(Duration.ofSeconds(30)),
</code></pre>
<p>常用指标：</p>
<ul>
<li>Page faults</li>
<li>Committed memory</li>
<li>Maximum active sessions</li>
<li>Thread counts</li>
<li>Transactions passed or failed</li>
<li>Error rate</li>
</ul>
<h2 id="3-性能测试步骤"><a href="#3-性能测试步骤" class="headerlink" title="3. 性能测试步骤"></a>3. 性能测试步骤</h2><h3 id="1-Identify-your-testing-environment"><a href="#1-Identify-your-testing-environment" class="headerlink" title="1. Identify your testing environment"></a>1. Identify your testing environment</h3><p>软硬件环境、网络配置、测试工具。</p>
<h3 id="2-Identify-the-performance-acceptance-criteria"><a href="#2-Identify-the-performance-acceptance-criteria" class="headerlink" title="2. Identify the performance acceptance criteria"></a>2. Identify the performance acceptance criteria</h3><p>针对 吞吐量、响应时间、资源占用等，设定被测程序可接受的性能指标。比如：</p>
<ul>
<li>1000 个用户同时访问网站时，响应时间不超过 4s。</li>
<li>应用崩溃前可处理器的最大并发用户数。</li>
<li>在峰值负载的情况下，CPU、内存的使用情况</li>
<li>测试应用在低、一般、大、超大负载情况下应用的响应时间、吞吐量。</li>
</ul>
<h3 id="3-规划设计性能测试方案"><a href="#3-规划设计性能测试方案" class="headerlink" title="3. 规划设计性能测试方案"></a>3. 规划设计性能测试方案</h3><p>对于测试指标因为人力、需求的不同，也没必要面面俱到， 根据需要和场景重点设计需要的测试类型：比如 Load Test, Endurance Test 等</p>
<h3 id="4-配置测试环境"><a href="#4-配置测试环境" class="headerlink" title="4. 配置测试环境"></a>4. 配置测试环境</h3><h3 id="5-实现并运行测试"><a href="#5-实现并运行测试" class="headerlink" title="5. 实现并运行测试"></a>5. 实现并运行测试</h3><h3 id="6-Analyze，Tune，Retest"><a href="#6-Analyze，Tune，Retest" class="headerlink" title="6. Analyze，Tune，Retest"></a>6. Analyze，Tune，Retest</h3><br/>

<hr>
<p>Reference:<br>[1]: <a target="_blank" rel="noopener" href="https://www.guru99.com/performance-testing.html">https://www.guru99.com/performance-testing.html</a><br>[2]: <a target="_blank" rel="noopener" href="https://www.onpathtesting.com/blog/performance-testing-metrics">https://www.onpathtesting.com/blog/performance-testing-metrics</a><br>[3]: <a target="_blank" rel="noopener" href="https://nbomber.com/docs/loadtesting-basics/">https://nbomber.com/docs/loadtesting-basics/</a><br>[4]: <a target="_blank" rel="noopener" href="https://medium.com/@novyludek/virtual-users-vs-rps-77627b384127">https://medium.com/@novyludek/virtual-users-vs-rps-77627b384127</a></p>

      
    </div>
    <footer>
      
        
        
  
  <div class="tags">
    <a href="/tags/%E7%AC%94%E8%AE%B0/">笔记</a>, <a href="/tags/%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95/">性能测试</a>
  </div>

      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>


<section id="comment">
  <h1 class="title">留言</h1>

  
      <div id="fb-root"></div>
<script>
  (function(d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return;
    js = d.createElement(s); js.id = id;
    js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=";
    fjs.parentNode.insertBefore(js, fjs);
  }(document, 'script', 'facebook-jssdk'));
</script>

<div class="fb-comments" data-href="https://dhyuan.github.io/2022/09/30/notes/test/Performance-Test-101/index.html" data-num-posts="5" data-width="840" data-colorscheme="light"></div>
      
  
</section>

</div></div>
    <aside id="sidebar" class="alignright">
  <div class="search">
  <form action="//google.com/search" method="get" accept-charset="utf-8">
    <input type="search" name="q" results="0" placeholder="搜索">
    <input type="hidden" name="as_sitesearch" value="dhyuan.github.io">
  </form>
</div>


  

  
<div class="widget tag">
  <h3 class="title">标签</h3>
  <ul class="entry">
  
    <li><a href="/tags/AWS/">AWS</a><small>2</small></li>
  
    <li><a href="/tags/CAS/">CAS</a><small>5</small></li>
  
    <li><a href="/tags/Concurrency/">Concurrency</a><small>6</small></li>
  
    <li><a href="/tags/DevOps/">DevOps</a><small>31</small></li>
  
    <li><a href="/tags/FP/">FP</a><small>2</small></li>
  
    <li><a href="/tags/Git/">Git</a><small>1</small></li>
  
    <li><a href="/tags/Ingerss/">Ingerss</a><small>1</small></li>
  
    <li><a href="/tags/Java/">Java</a><small>10</small></li>
  
    <li><a href="/tags/Kubernetes/">Kubernetes</a><small>3</small></li>
  
    <li><a href="/tags/Maven/">Maven</a><small>2</small></li>
  
    <li><a href="/tags/MicroService/">MicroService</a><small>3</small></li>
  
    <li><a href="/tags/MongoDB/">MongoDB</a><small>6</small></li>
  
    <li><a href="/tags/Nginx/">Nginx</a><small>2</small></li>
  
    <li><a href="/tags/Reactive/">Reactive</a><small>8</small></li>
  
    <li><a href="/tags/SAGA/">SAGA</a><small>1</small></li>
  
    <li><a href="/tags/Scala/">Scala</a><small>7</small></li>
  
    <li><a href="/tags/Security/">Security</a><small>12</small></li>
  
    <li><a href="/tags/Spring/">Spring</a><small>14</small></li>
  
    <li><a href="/tags/android/">android</a><small>1</small></li>
  
    <li><a href="/tags/network/">network</a><small>2</small></li>
  
    <li><a href="/tags/%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95/">性能测试</a><small>1</small></li>
  
    <li><a href="/tags/%E7%AC%94%E8%AE%B0/">笔记</a><small>13</small></li>
  
    <li><a href="/tags/%E7%BD%91%E4%B8%8A%E5%A5%BD%E6%96%87/">网上好文</a><small>1</small></li>
  
  </ul>
</div>


  
  <div class="widget widget-archives">
    <h3 class="title">归档</h3>
    <div class="entry">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/06/">六月 2024</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/05/">五月 2023</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/02/">二月 2023</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/11/">十一月 2022</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/09/">九月 2022</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/08/">八月 2022</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/05/">五月 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/10/">十月 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/07/">七月 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/05/">五月 2021</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/04/">四月 2021</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/03/">三月 2021</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/02/">二月 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/12/">十二月 2020</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/11/">十一月 2020</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">十月 2020</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">九月 2020</a><span class="archive-list-count">11</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">五月 2020</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/04/">四月 2020</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">三月 2020</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">二月 2020</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">十月 2019</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">九月 2019</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">九月 2018</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">八月 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/11/">十一月 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/09/">九月 2016</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/08/">八月 2016</a><span class="archive-list-count">1</span></li></ul>
    </div>
  </div>


</aside>
    <div class="clearfix"></div>
  </div>
  <footer id="footer" class="inner"><div class="alignleft">
  
  &copy; 2025 Dahui
  
</div>
<div class="clearfix"></div></footer>
  
<script src="/js/jquery-3.4.1.min.js"></script>


<script src="/js/jquery.imagesloaded.min.js"></script>


<script src="/js/gallery.js"></script>






<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">


<script src="/fancybox/jquery.fancybox.pack.js"></script>

<script>
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>

</body>
</html>
